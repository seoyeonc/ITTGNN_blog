<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.527">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2024-01-08">

<title>ITTGNN_blog - Research Sections of Experiments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">ITTGNN_blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/sy_hub/"> 
<span class="menu-text">Main_Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Research Sections of Experiments</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Research Sections of Experiments</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>SEOYEON CHOI </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 8, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../1_studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Studies</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>Research</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Research</strong></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><strong>Result</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../3_table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Table</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../3_figure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Figure</strong></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data" id="toc-data" class="nav-link active" data-scroll-target="#data">Data</a></li>
  <li><a href="#missing-rate" id="toc-missing-rate" class="nav-link" data-scroll-target="#missing-rate">1. Missing Rate</a>
  <ul class="collapse">
  <li><a href="#trend" id="toc-trend" class="nav-link" data-scroll-target="#trend">1.1 Trend</a></li>
  <li><a href="#every-model" id="toc-every-model" class="nav-link" data-scroll-target="#every-model">1.2 Every model</a></li>
  <li><a href="#six-datasets" id="toc-six-datasets" class="nav-link" data-scroll-target="#six-datasets">1.3 Six Datasets</a></li>
  <li><a href="#time" id="toc-time" class="nav-link" data-scroll-target="#time">2.1 Time</a></li>
  <li><a href="#node" id="toc-node" class="nav-link" data-scroll-target="#node">2.2 Node</a></li>
  </ul></li>
  <li><a href="#interpolation" id="toc-interpolation" class="nav-link" data-scroll-target="#interpolation">3 Interpolation</a>
  <ul class="collapse">
  <li><a href="#linear-vs-nearest" id="toc-linear-vs-nearest" class="nav-link" data-scroll-target="#linear-vs-nearest">3.1 Linear vs Nearest</a></li>
  </ul></li>
  <li><a href="#missing-type" id="toc-missing-type" class="nav-link" data-scroll-target="#missing-type">4 Missing Type</a>
  <ul class="collapse">
  <li><a href="#block-vs-random" id="toc-block-vs-random" class="nav-link" data-scroll-target="#block-vs-random">4.1 Block vs random</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>https://arxiv.org/pdf/1609.02907.pdf%EF%BC%89</p>
<p>gnn은 최근 다양한 분야에서 그래프 데이터 분석하는 모델이 되어왔다. 동적 데이터를 다루기 위해서 gnn은 stgnn아래 사용되어 왔다. stgnn이 다변량 시계열 채널 간의 미세한 공간적 연관성을 명시적으로 모델링할 수 있어, 기본 그래프 구조는 고정되어 있지만 노드 특성이 시간에 따라 동적으로 업데이트되는 시나리오에 특히 적합하다. 초기 연구에서는 rnn을 사용하여 시간 종속성을 캡쳐하고 gnn을 사용하여 공간 관계를 모델링하여 다변량 시계열을 예측하는 데 사용되는 순환 기반 stgnn이 제안 되었다. 이후로 stgnn 분야는 다양한 시계열 응용 프로그램에 대처하기 위해 제안된 다양한 아키텍쳐로 번성했다. 이 중에는 예측과 분류 같은 응용이 포함되어 있다. 다변량 시계열 이상치감지를 위해 최근에 stgnn을 활용하여 단계적 예측을 수행하고 정규화된 예측 오류를 계산하여 이상을 감지하는 GDn을 제안했다. MTAD-GAT는 이상을 감지하기 위해 연합 예측 및 재구성 기반 stgnn을 활용한다. Fusagnet은 stgnn의 희소 제약된 연합 최적화를 통해 mtad-gat를 확장한다. 현재의 깊은 감지 기술은 중요한 발전을 이루었지만, 현재의 불규칙한 시계열 설정에서는 각 타임 스탬프에서 실제 관측값이 완전히 사용 가능해야 하는데, 이는 불가능하다. 이 연구에서는 dg-node 공간 및 시간 모듈을 사용하여 불규칙한 시계열을 처리하기 위해 stgnn을 활용하고, 실시간으로 강력학 이상 감지를 달성하기 위해 gst-pro의 원래 예측에 대한 간단한 분포 접근 방식을 제안한다.</p>
<hr>
<p>related works gcn은 cnn이 graph로 효율적으로 확장된 분야로 증명되어 왔다. 그래프 도메인에서 , 특히 입력 데이터가 시간 변수인 것을 처리하기 위해 동적 그래프의 개념이 사용되었으며, 이 그래프는 시간에 따라 정보가 변하기 때문에 시간과 공간의 정보를 캡쳐하여 사용한다면 효과적일 것이다. 이에 dcrnn과 stgcn이 제안되었고, 이러한 방법이다. dcrnn에서는 Missing values are excluded in calculating these metrics가 되었고, stgcn에서는 . The linear interpolation method is used to fill missing values after data cleaning. In addition, data input are normalized by Z-Score method. 이렇게 되었다. st-gcn에서는 This transformation is interpolated for intermediate frames to generate a effect as if we smoothly move the view point during playback. We name this augmentation as random moving. 이렇게 보간하는 방법을 사용하기도 했다. st data와 관련하여 method가 제안될때 다양한 방법으로 irregular에서 regular로 변환하여 사용하려는 시도가 되어져 왔고 대부분 simple handle하는 방법을 사용했다. 하지만 이는 실제 관측값이 아니며, 이는 데이터를 예측하거나 분류할때 영향을 끼쳐 낮은 accuracy로 이끌 수 있다. 이를 개선할 수 있는 방법이 제안된다면 기존에 제안된 st data에 사용된 방법들의 더 정확한 예측값을 얻는 등 효과적인 결과를 이끌 수 있을 것이다. 이에 우리 연구에서는 missing 값을 처리 후 데이터의 normal trend를 활용하여 self consistecy 속성을 이용해 데이터의 예측 정확도를 키울 수 있는 접근 방식을 제안한다.</p>
<p>The validation set is comprised of the final 20% of the training data.</p>
<ol type="1">
<li>mrate 에 따라 mse</li>
<li>time/node ration에 따라 mse</li>
<li>기타(interpolation 등)</li>
</ol>
<div id="8323b849-e384-4b01-ab93-cbd21978f529" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span></code></pre></div>
</div>
<div id="2370ef55-1730-42af-b705-51d12ba6f9f1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pd.options.plotting.backend <span class="op">=</span> <span class="st">"plotly"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pio.templates.default <span class="op">=</span> <span class="st">"plotly_white"</span></span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'pd' is not defined</code></pre>
</div>
</div>
<section id="data" class="level1">
<h1>Data</h1>
<div id="0029d80d-2795-480c-9753-0075f29de94c" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'../Data/Body_Results.csv'</span>).query(<span class="st">"method!='GNAR'"</span>).iloc[:,<span class="dv">1</span>:]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'pd' is not defined</code></pre>
</div>
</div>
<div id="10c5e1e5-ffec-4c40-906f-b3e57db93daf" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nearest_fivenodes <span class="op">=</span> pd.read_csv(<span class="st">'../Data/Add/nearest_fivenodes.csv'</span>).query(<span class="st">"method!='GNAR'"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>nearest_fivenodes.head()</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'pd' is not defined</code></pre>
</div>
</div>
<div id="af336051-d22a-426e-9410-be00b1d0e30f" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>nearest_pedalme <span class="op">=</span> pd.read_csv(<span class="st">'../Data/Add/nearest_pedalme.csv'</span>).query(<span class="st">"method!='GNAR'"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>nearest_pedalme.head()</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'pd' is not defined</code></pre>
</div>
</div>
</section>
<section id="missing-rate" class="level1">
<h1>1. Missing Rate</h1>
<section id="trend" class="level2">
<h2 class="anchored" data-anchor-id="trend">1.1 Trend</h2>
<ul>
<li>실험 결과에 대한 첫번 째 접근은 다음과 같다. Figure 1의 결과는 각 결측값 비율에 따라 정리한 데이터셋에 대한 결과이다. Classic과 Proposed는 결측값 비율이 점점 증가하면서 평균제곱오차도 함께 증가하는 경향을 보였다. 특히, Classic과 Proposed 각각에 대한 trendline을 비교해본 결과, 결측값 비율이 증가할 수록 Classic에 비해 우리가 제안한 방법((Proposed)의 평균제곱오차가 느리게 증가하는 경향을 띄었다. 반면, Classic 모델은 오히려 빠르게 증가하는 경향을 띄었다. 결측값 비율이 커질수록 우리가 제안하는 방법이 비교적 낮은 오차 내에서 값을 예측해낸다는 것을 알 수 있었다.</li>
<li>The initial approach to the experimental results is as follows. Figure <span class="math inline">\(\ref{}\)</span> illustrates the outcomes for six datasets organized based on varying levels of missing data, with nine models employed. As the missing data rates increase, both Classic and Proposed models exhibit a tendency for the mean squared error (MSE) to rise. Particularly noteworthy is the comparison between the trendlines of Classic and Proposed: as the rate of missing values increases, the MSE of the Proposed method tends to increase more gradually compared to Classic. In contrast, the Classic model displays a more rapid increase in MSE. This comparison suggests that as the proportion of missing values grows, our proposed method (Proposed) tends to predict values with a slower increase in MSE compared to the Classic model. It becomes evident that as the missing data rate becomes higher, our proposed method performs relatively well, providing predictions with lower errors compared to the Classic model.</li>
</ul>
<div id="f64c5814-4ecf-4d32-b113-feeb62a34d2b" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>z<span class="co"># tidydata = pd.concat([df.query('dataset=="fivenodes" and model=="GConvGRU" and mtype=="rand"')])</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['mrate'] = tidydata['mrate'].astype(str)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = tidydata.sort_values(by=['model','mrate'])</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fig = px.box(tidydata,x='mrate',y='mse',color='method',width=70, log_y=True)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['xaxis']['title']['text']='Missing Rate'</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['yaxis']['title']['text']='Mean Square Error'</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[0]['marker']['color'] = 'blue'</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[0]['name'] = 'Classic'</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[1]['marker']['color'] = 'red'</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[1]['name'] = 'Proposed'</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['legend']['title']=''</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(template="seaborn")</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(title_text="Randomly Missing Values on FiveVTS")</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(height=600, width=1800)</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.add_trace(go.Scatter(x=tidydata.query('method=="STGCN"').mrate.unique(), y=(tidydata.query('method=="STGCN"')).groupby('mrate')['mse'].mean(), </span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                          mode="lines", name="trendline of Classic", line=dict(color="blue",width=2)))</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.add_trace(go.Scatter(x=tidydata.query('method=="STGCN"').mrate.unique(), y=(tidydata.query('method!="STGCN"')).groupby('mrate')['mse'].mean(), </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                          mode="lines", name="trendline of Classic", line=dict(color="red",width=2)))</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(legend=dict(</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     yanchor="top",</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     y=0.99,</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     xanchor="left",</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     x=0.01</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co"># ))</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co"># fig</span></span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'z' is not defined</code></pre>
</div>
</div>
</section>
<section id="every-model" class="level2">
<h2 class="anchored" data-anchor-id="every-model">1.2 Every model</h2>
<p><code>1</code>의 내용에 대한 확장으로. <code>FiveVTS</code> 데이터 셋에서 <code>GConvGRU</code> 방법 이외에 시도한 다른 Classic 모델들에 대한 결과이다. <code>GConvGRU</code>, <code>GConvLSTM</code>, <code>GCLSTM</code>, <code>LRGCN</code>, <code>DyGrEncoder</code>, <code>EvolveGCNH</code>, <code>EvolveGCNO</code>, <code>TGCN</code>, <code>DCRNN</code> 모델의 결과이며. 첫번째 섹션에서 제시한 결과와 비슷하게 결측값 비율이 증가할 수록 예측값에 대한 오차가 증가하였으며. Proposed가 더 낮은 값을 띄는 경향을 보인 것을 확인할 수 있었다. 다른 데이터 셋에 대한 결과도 결측값이 증가할 수록 오차가 증가하되, 우리가 제안한 방법에 대한 mse값이 낮은 비슷한 경향을 보였으며, 나머지 모델에서 나온 6개의 데이터 셋에 대한 결과는 부록에서 확인할 수 있다.</p>
<div id="6ca274e8-871f-44a2-8d63-7fa0b53b615b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = pd.DataFrame(df.query("dataset=='fivenodes' and mtype=='rand'"))</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['model'] = pd.Categorical(tidydata['model'], categories=["GConvGRU", "GConvLSTM", "GCLSTM", "LRGCN", "DyGrEncoder", "EvolveGCNH", "EvolveGCNO", "TGCN", "DCRNN"])</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['method'] = pd.Categorical(tidydata['method'], categories=['STGCN', 'IT-STGCN'])</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['mrate'] = tidydata['mrate'].astype(str)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = tidydata.sort_values(by=['model','mrate'])</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fig = px.box(tidydata,x='mrate',y='mse',color='method',log_y=True,facet_col='model',facet_col_wrap=3)</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['xaxis']['title']['text']=''</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['xaxis2']['title']['text']='Missing Rate'</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['xaxis3']['title']['text']=''</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['yaxis']['title']['text']=''</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['yaxis4']['title']['text']='MSE(log scale)'</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['yaxis7']['title']['text']=''</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['legend']['title']='Method'</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.xaxis4.showticklabels=True</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.xaxis5.showticklabels=True</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.xaxis6.showticklabels=True</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.xaxis7.showticklabels=True</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.xaxis8.showticklabels=True</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.xaxis9.showticklabels=True</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.yaxis2.showticklabels=True</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.yaxis3.showticklabels=True</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.yaxis5.showticklabels=True</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.yaxis6.showticklabels=True</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.yaxis8.showticklabels=True</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.yaxis9.showticklabels=True</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['legend']['title']=''</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(0, 9):</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     fig.data[i]['marker']['color'] = 'blue'</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     fig.data[i]['name'] = 'Classic'</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="co"># for i in range(9, 18):    </span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     fig.data[i]['marker']['color'] = 'red'</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     fig.data[i]['name'] = 'Proposed'</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(legend=dict(x=1, y=1, traceorder='normal', orientation='v'))</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(template="seaborn")</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(title_text="Models on FiveVTS")</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(height=1200, width=1900)</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.for_each_annotation(lambda a: a.update(text=a.text.split("=")[-1]))</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(legend=dict(</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     yanchor="top",</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="co">#     y=0.99,</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     xanchor="left",</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="co">#     x=0.01</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="co"># ))</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="co"># fig</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="co"># # with open('fivenodes_fig.pkl', 'wb') as file:</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="co"># #     pickle.dump(fig, file)</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="co"># # with open('fivenodes_fig.pkl', 'rb') as file:</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="co"># #     fivenodes_fig = pickle.load(file)</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a><span class="co"># # fivenodes_fig</span></span></code></pre></div>
</div>
</section>
<section id="six-datasets" class="level2">
<h2 class="anchored" data-anchor-id="six-datasets">1.3 Six Datasets</h2>
<ul>
<li>이번 섹션에서는 데이터의 다양성을 고려하기 위하여 사용된 총 6개의 데이터에 대해 결측값 비율이 높을때(70% 혹은 80%) <code>GConvGRU</code> 모델에서 예측과 제안된 방법의 비교 결과를 제시하였다. 대부분의 데이터셋의 결과는 Classic 모델보다 Proposed 결과의 mse 값이 낮게 분포되어 있음을 확인하였다.</li>
</ul>
<div id="bd8d3b40-50a7-41a6-9e40-b451352b3111" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = pd.concat([df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==12) &amp; </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#            (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='GConvGRU') &amp; (df['mrate'].isin([0.8]))],</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#         df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==16 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.8)"),</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#           df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.8)"),</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#           df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.8)"),</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#           df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.7)"),</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#           df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.8)")])</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # tidydata = df.query("dataset=='fivenodes' and mtype=='rand' and mrate in [0.7,0.8]")</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['model'] = pd.Categorical(tidydata['model'], categories=["GConvGRU", "GConvLSTM", "GCLSTM", "LRGCN", "DyGrEncoder", "EvolveGCNH", "EvolveGCNO", "TGCN", "DCRNN"])</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># categories=["fivenodes", "chickenpox", "pedalme", "wikimath", "windmillsmall", "monte"]</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['method'] = pd.Categorical(tidydata['method'], categories=['STGCN', 'IT-STGCN'])</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = tidydata.sort_values(by='dataset', key=lambda x: x.map({dataset: i for i, dataset in enumerate(categories)}))</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># fig = px.strip(tidydata,x='dataset',y='mse',color='method', log_y=True,stripmode='overlay')</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['xaxis']['title']['text']='Missing Rate'</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['yaxis']['title']['text']='MSE(log scale)'</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # fig.layout.annotations[0].text = 'FiveVTS'</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # fig.layout.annotations[1].text = 'Chickenpox'</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># # fig.layout.annotations[2].text = 'Pedalme'</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # fig.layout.annotations[3].text = 'Wikimath'</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # fig.layout.annotations[4].text = 'Windmillsmall'</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># # fig.layout.annotations[5].text = 'MontevideoBus'</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># # fig.layout['legend']['title']=''</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[0]['marker']['color'] = 'blue'</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[0]['name'] = 'Classic'</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[1]['marker']['color'] = 'red'</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[1]['name'] = 'Proposed'</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(template="seaborn")</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(title_text="GConvGRU on datasets")</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # fig.update_yaxes(matches=None)</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(height=800, width=1900)</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(legend=dict(</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     yanchor="top",</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     y=0.99,</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     xanchor="left",</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     x=0.01</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co">#  ))</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="co"># fig</span></span></code></pre></div>
</div>
<hr>
<p><strong>DCRNN 모델의 wikimath 데이터에서 결측값 비율이 낮을 때 대비 높을 때 비교</strong></p>
<ul>
<li><p>결측값 비율이 커지니 차이가 커진 mse 값 분포</p></li>
<li><p>내용</p>
<ul>
<li>wikimath 데이터셋에서 DCRNN 결과에 대하여 결측값 비율이 작은 경우(30%) 대비 큰 경(80%)에 대하여 비교해보았다. wikimath 데이터셋에서 결측값을 주지 않았을떄, mse 값은 0.936±0.002(mean±sd)와 같았다. figure에서 보다시피, 결측값 비율이 30%으로 작을 때는 오차값이 작게 증가하였지만, 결측값의 비율이 80%로 높아졌을떄는 mse값이 확연히 높아진 것을 확인할 수 있었으며, 특히 classic 보다 proposed 의 값이 낮은 모습도 확인할 수 있었다.</li>
</ul></li>
</ul>
<div id="5829ab13-b75b-4b76-a143-bfc53b3f7b2d" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # tidydata = pd.concat([df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==12) &amp; </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #            (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='GConvGRU') &amp; (df['mrate'].isin([0.3,0.8]))]])</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = df.query("model=='DCRNN' and dataset=='wikimath' and mrate in [0.3,0.8]")</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['method'] = pd.Categorical(tidydata['method'], categories=['STGCN', 'IT-STGCN'])</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['mrate'] = tidydata['mrate'].astype(str)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = tidydata.sort_values(by=['model','mrate'])</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fig = px.box(tidydata,x='mrate',y='mse',width=10, points='all',log_y=True,facet_col='method')</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['xaxis2']['title']['text']='Missing Rate'</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['xaxis']['title']['text']='Missing Rate'</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['yaxis']['title']['text']='MSE(log scale)'</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[0]['marker']['color'] = 'blue'</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.data[1]['marker']['color'] = 'red'</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout['legend']['title']=''</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.annotations[0].text = 'Classic'</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.annotations[1].text = 'Proposed'</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(template="seaborn")</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(title_text="DCRNN on Wikimath")</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(height=1000, width=1500)</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(legend=dict(</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     yanchor="top",</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     y=0.99,</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     xanchor="left",</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     x=0.01</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#  ))</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co"># fig</span></span></code></pre></div>
</div>
<hr>
<div id="201e1978-6909-4d24-9373-20fdde4af2f1" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> df.query(<span class="st">"mtype=='rand'"</span>).query(<span class="st">"dataset != 'windmillsmall'"</span>)<span class="op">\</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>.groupby([<span class="st">"method"</span>,<span class="st">"dataset"</span>,<span class="st">"mrate"</span>,<span class="st">"model"</span>]).agg({<span class="st">'mse'</span>:<span class="st">'mean'</span>}).reset_index()<span class="op">\</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>.plot.line(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'mrate'</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'mse'</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'method'</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    facet_row<span class="op">=</span><span class="st">'model'</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    facet_col<span class="op">=</span><span class="st">'dataset'</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">1200</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">1500</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> scatter <span class="kw">in</span> fig.data:</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    scatter[<span class="st">'mode'</span>] <span class="op">=</span> <span class="st">'lines+markers'</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    scatter[<span class="st">'line'</span>][<span class="st">'dash'</span>] <span class="op">=</span> <span class="st">'dashdot'</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> annotation <span class="kw">in</span> fig.layout[<span class="st">'annotations'</span>]:</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    annotation[<span class="st">'text'</span>] <span class="op">=</span> annotation[<span class="st">'text'</span>].replace(<span class="st">'dataset='</span>,<span class="st">''</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    annotation[<span class="st">'text'</span>] <span class="op">=</span> annotation[<span class="st">'text'</span>].replace(<span class="st">'model='</span>,<span class="st">''</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> [k <span class="cf">for</span> k <span class="kw">in</span> fig.layout <span class="cf">if</span> <span class="st">'xaxis'</span> <span class="kw">in</span> k]:</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    fig.layout[k][<span class="st">'title'</span>][<span class="st">'text'</span>] <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> [k <span class="cf">for</span> k <span class="kw">in</span> fig.layout <span class="cf">if</span> <span class="st">'yaxis'</span> <span class="kw">in</span> k]:</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    fig.layout[k][<span class="st">'title'</span>][<span class="st">'text'</span>] <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(showticklabels<span class="op">=</span><span class="va">True</span>,matches<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(showticklabels<span class="op">=</span><span class="va">True</span>,matches<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'df' is not defined</code></pre>
</div>
</div>
<div id="876208b4-bcc7-4f1a-827e-25bf9d960cb0" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>big <span class="op">=</span> df.query(<span class="st">"mtype=='rand'"</span>).query(<span class="st">"dataset == 'wikimath'"</span>).query(<span class="st">"model == 'GConvLSTM'"</span>).sort_values(by<span class="op">=</span><span class="st">'mrate'</span>)<span class="op">\</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>.assign(mrate_jittered <span class="op">=</span> <span class="kw">lambda</span> df: np.array(df[<span class="st">'mrate'</span>])<span class="op">+</span>np.random.randn(<span class="bu">len</span>(df[<span class="st">'mrate'</span>]))<span class="op">*</span><span class="fl">0.01</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>small <span class="op">=</span> big.groupby([<span class="st">"dataset"</span>,<span class="st">"mrate"</span>,<span class="st">"method"</span>]).agg({<span class="st">'mse'</span>:<span class="st">'mean'</span>}).reset_index().rename({<span class="st">'mse'</span>:<span class="st">'mse_mean'</span>},axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>tidydata <span class="op">=</span> big.merge(small)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>tidydata[<span class="st">'mrate'</span>] <span class="op">=</span> tidydata[<span class="st">'mrate'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    tidydata,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'mse'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'mrate_jittered'</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    opacity<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'method'</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="dv">750</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>_fig1 <span class="op">=</span> px.scatter(</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    tidydata,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'mse_mean'</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'mrate'</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'method'</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>_fig1.data[<span class="dv">0</span>][<span class="st">'mode'</span>]<span class="op">=</span><span class="st">'markers+lines'</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>_fig1.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'size'</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>_fig1.data[<span class="dv">0</span>][<span class="st">'line'</span>][<span class="st">'width'</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>_fig1.data[<span class="dv">0</span>][<span class="st">'line'</span>][<span class="st">'dash'</span>] <span class="op">=</span> <span class="st">'dashdot'</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>_fig1.data[<span class="dv">1</span>][<span class="st">'mode'</span>]<span class="op">=</span><span class="st">'markers+lines'</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>_fig1.data[<span class="dv">1</span>][<span class="st">'marker'</span>][<span class="st">'size'</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>_fig1.data[<span class="dv">1</span>][<span class="st">'line'</span>][<span class="st">'width'</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>_fig1.data[<span class="dv">1</span>][<span class="st">'line'</span>][<span class="st">'dash'</span>] <span class="op">=</span> <span class="st">'dashdot'</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>_fig2 <span class="op">=</span> px.violin(</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    tidydata.query(<span class="st">"method=='STGCN'"</span>),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'mse'</span>,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'mrate'</span>,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>_fig2.data[<span class="dv">0</span>][<span class="st">'opacity'</span>]<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>_fig2.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>]<span class="op">=</span><span class="st">'#636efa'</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>_fig3 <span class="op">=</span> px.violin(</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    tidydata.query(<span class="st">"method=='IT-STGCN'"</span>),</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'mse'</span>,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'mrate'</span>,</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>_fig3.data[<span class="dv">0</span>][<span class="st">'opacity'</span>]<span class="op">=</span><span class="fl">0.7</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>_fig3.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>]<span class="op">=</span><span class="st">'#EF553B'</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>_fig3</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> g <span class="kw">in</span> _fig1.data:</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(g)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> g <span class="kw">in</span> _fig2.data:</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(g)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> g <span class="kw">in</span> _fig3.data:</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(g)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'showlegend'</span>] <span class="op">=</span><span class="va">False</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'showlegend'</span>] <span class="op">=</span><span class="va">False</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'xaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'Missign Rate'</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'yaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'MSE'</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'legend'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">""</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'Wikimath/GConvLSTM'</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'df' is not defined</code></pre>
</div>
</div>
</section>
<section id="time" class="level2">
<h2 class="anchored" data-anchor-id="time">2.1 Time</h2>
<div id="454a64a5-6ff8-45bf-96da-c01681f7552d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_dataset <span class="op">=</span> pd.DataFrame([[i,<span class="dv">0</span>,<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">set</span>(df.dataset)])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_dataset.columns <span class="op">=</span> [<span class="st">'dataset'</span>,<span class="st">'node'</span>,<span class="st">'time'</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>dataset_values <span class="op">=</span> {</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'fivenodes'</span>: {<span class="st">'time'</span>: <span class="dv">200</span>, <span class="st">'node'</span>: <span class="dv">5</span>},</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'chickenpox'</span>: {<span class="st">'time'</span>: <span class="dv">522</span>, <span class="st">'node'</span>: <span class="dv">20</span>},</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'pedalme'</span>: {<span class="st">'time'</span>: <span class="dv">36</span>, <span class="st">'node'</span>: <span class="dv">15</span>},</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'wikimath'</span>: {<span class="st">'time'</span>: <span class="dv">731</span>, <span class="st">'node'</span>: <span class="dv">1068</span>},</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'windmillsmall'</span>: {<span class="st">'time'</span>: <span class="dv">17472</span>, <span class="st">'node'</span>: <span class="dv">11</span>},</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'monte'</span>: {<span class="st">'time'</span>: <span class="dv">744</span>, <span class="st">'node'</span>: <span class="dv">675</span>},</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset, values <span class="kw">in</span> dataset_values.items():</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    df_dataset.loc[df_dataset[<span class="st">'dataset'</span>] <span class="op">==</span> dataset, [<span class="st">'time'</span>, <span class="st">'node'</span>]] <span class="op">=</span> values.values()</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>df_dataset</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>df_dataset</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'pd' is not defined</code></pre>
</div>
</div>
<p><strong>time이 적은 pedalme 데이터와 time이 많은 windmillsmall 데이터의 결측값 비율이 높을 때(70% 혹은 80%) 비교</strong></p>
<ul>
<li>내용
<ul>
<li>이 섹션에서는 train 데이터 양에 따라 학습 결과를 논의해보고자 한다. 데이터가 적은 pedalme(node=15, time=36) 데이터는 proposed method 가 dramatic한 낮은 error값을 보이지 않았다. 반면에 time이 긴 windmillsmall(node=11, time=17472)은 proposed method가 결측값이 많을 때 mse 값이 낮게 나온 모습을 볼 수 있었다. underline function을 추정하여 true 겂을 따라가려는 우리 방법론이 효율적이기 위해서 데이터 양이 많을 경우가 좋다. time이 길거나(예를 들어 오랜 기간 어떤 기계의 센서에서 측정된 값) node가 많은(측정 지점이 많은) 경우가 실제 시공간 데이터의 경우 많을 것을 기대하기 떄문에, proposed의 효과가 있을 경우가 존재할 것이다.</li>
<li>According to the table (dataset explanation), the Time for the ‘Pedalme’ dataset is 36, while the time for the ‘Windmillsmall’ dataset is 17,472. Thus, the two datasets have different amounts of data. We compared between two datasets, and the result is on Figure 555. The variations observed in Figure 555 for each dataset indicate that the disparity between methods is relatively small for the ‘Pedalme’ dataset, whereas the difference is more pronounced for the ‘Windmillsmall’ dataset.This phenomenon arises as the increasing quantity of data facilitates learning patterns and trends. Consequently, our approach signifies its effectiveness when there is a substantial amount of data in the time aspect.</li>
</ul></li>
</ul>
<div id="98acf431-d302-4f1f-a230-f8050edd97e3" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pedalme node = 15 time = 36</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># windmill node = 11 time = 17,472</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>tidydata <span class="op">=</span> pd.concat([</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>          df.query(<span class="st">"dataset=='pedalme' &amp; mtype=='rand'  &amp; model=='GCLSTM' &amp; (mrate == 0.8)"</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>          df.query(<span class="st">"dataset=='windmillsmall' &amp; mtype=='rand' &amp;  model=='GCLSTM' &amp; (mrate == 0.7)"</span>)])</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>tidydata[<span class="st">'method'</span>] <span class="op">=</span> pd.Categorical(tidydata[<span class="st">'method'</span>], categories<span class="op">=</span>[<span class="st">'STGCN'</span>, <span class="st">'IT-STGCN'</span>])</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>tidydata <span class="op">=</span> tidydata.sort_values(by<span class="op">=</span>[<span class="st">'dataset'</span>,<span class="st">'model'</span>,<span class="st">'mrate'</span>])</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.box(tidydata,x<span class="op">=</span><span class="st">'dataset'</span>,y<span class="op">=</span><span class="st">'mse'</span>,color<span class="op">=</span><span class="st">'method'</span>,width<span class="op">=</span><span class="dv">70</span>, log_y<span class="op">=</span><span class="va">True</span>, points<span class="op">=</span><span class="st">"all"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'xaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">''</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'yaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'MSE(log scale)'</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'blue'</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Classic'</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Proposed'</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.annotations[0].text = 'Pedalme'</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.annotations[1].text = 'Windmillsmall'</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'legend'</span>][<span class="st">'title'</span>]<span class="op">=</span><span class="st">''</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>fig.update_layout(template<span class="op">=</span><span class="st">"seaborn"</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title_text<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">800</span>, width<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">0.99</span>,</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.01</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a> ))</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'pd' is not defined</code></pre>
</div>
</div>
</section>
<section id="node" class="level2">
<h2 class="anchored" data-anchor-id="node">2.2 Node</h2>
<div id="2a7d9980-0894-4633-bc5c-9fe2c6a60376" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wikimath nodes = 1068 time = 731</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># monte nodes = 675 time = 744</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>tidydata <span class="op">=</span> pd.concat([</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>          df.query(<span class="st">"dataset=='wikimath' &amp; mtype=='rand'  &amp; model=='GCLSTM' &amp; (mrate == 0.8)"</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>          df.query(<span class="st">"dataset=='monte' &amp; mtype=='rand' &amp;  model=='GCLSTM' &amp; (mrate == 0.8)"</span>)])</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>tidydata[<span class="st">'method'</span>] <span class="op">=</span> pd.Categorical(tidydata[<span class="st">'method'</span>], categories<span class="op">=</span>[<span class="st">'STGCN'</span>, <span class="st">'IT-STGCN'</span>])</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>tidydata <span class="op">=</span> tidydata.sort_values(by<span class="op">=</span>[<span class="st">'dataset'</span>,<span class="st">'model'</span>,<span class="st">'mrate'</span>])</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.box(tidydata,x<span class="op">=</span><span class="st">'dataset'</span>,y<span class="op">=</span><span class="st">'mse'</span>,color<span class="op">=</span><span class="st">'method'</span>,width<span class="op">=</span><span class="dv">70</span>, log_y<span class="op">=</span><span class="va">True</span>, points<span class="op">=</span><span class="st">"all"</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'xaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'Missing Rate'</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'yaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'MSE(log scale)'</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'blue'</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Classic'</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Proposed'</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'legend'</span>][<span class="st">'title'</span>]<span class="op">=</span><span class="st">''</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>fig.update_layout(template<span class="op">=</span><span class="st">"seaborn"</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title_text<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">800</span>, width<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">0.99</span>,</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.01</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a> ))</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'pd' is not defined</code></pre>
</div>
</div>
<div id="8810a0b8-0570-402f-8f48-4a91dfc96212" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fivenodes = pd.concat([</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==12) &amp; </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='GConvGRU') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))],</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==12) &amp; </span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='GConvLSTM') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))],</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==4) &amp; </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='GCLSTM') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))],</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==4) &amp; </span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='LRGCN') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))],</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==12) &amp; </span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='DyGrEncoder') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))],</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['lags']==2) &amp; </span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['epoch']==50) &amp; (df['model']=='EvolveGCNH') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))],</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['lags']==2) &amp; </span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['epoch']==50) &amp; (df['model']=='EvolveGCNO') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))],</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==12) &amp; </span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='TGCN') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))],</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     df[(df['dataset']=='fivenodes') &amp; (df['mtype']=='rand') &amp; (df['inter_method']=='linear') &amp; (df['nof_filters']==2) &amp; </span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co">#        (df['lags']==2) &amp; (df['epoch']==50) &amp; (df['model']=='DCRNN') &amp; (df['mrate'].isin([0.3, 0.5, 0.6, 0.7, 0.8]))]</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ])</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co"># fivenodes['nodes'] = 5</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># fivenodes['time'] = 200</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co"># fivenodes = fivenodes.query("mrate==0.8")</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># chickenpox = pd.concat([</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==16 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==32 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==16 &amp; lags==4 &amp; epoch==50 &amp; model=='GCLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==8 &amp; lags==4 &amp; epoch==50 &amp; model=='LRGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='DyGrEncoder' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; lags==4 &amp; epoch==50 &amp; model=='EvolveGCNH' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; lags==4 &amp; epoch==50 &amp; model=='EvolveGCNO' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='TGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='chickenpox' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==16 &amp; lags==4 &amp; epoch==50 &amp; model=='DCRNN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)")</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ])</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="co"># chickenpox['nodes'] = 20</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="co"># chickenpox['time'] = 522</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="co"># chickenpox = chickenpox.query("mrate==0.8")</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="co"># pedalme = pd.concat([</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==2 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==4 &amp; lags==4 &amp; epoch==50 &amp; model=='GCLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==8 &amp; lags==4 &amp; epoch==50 &amp; model=='LRGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='DyGrEncoder' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; lags==4 &amp; epoch==50 &amp; model=='EvolveGCNH' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; lags==4 &amp; epoch==50 &amp; model=='EvolveGCNO' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='TGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='pedalme' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==8 &amp; lags==4 &amp; epoch==50 &amp; model=='DCRNN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)")</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a><span class="co"># ], ignore_index=True)</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="co"># pedalme['nodes'] = 15</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="co"># pedalme['time'] = 36</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="co"># pedalme = pedalme.query("mrate==0.8")</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="co"># wikimath = pd.concat([</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==64 &amp; lags==8 &amp; epoch==50 &amp; model=='GConvLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==64 &amp; lags==8 &amp; epoch==50 &amp; model=='GCLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==32 &amp; lags==8 &amp; epoch==50 &amp; model=='LRGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='DyGrEncoder' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; lags==8 &amp; epoch==50 &amp; model=='EvolveGCNH' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; lags==8 &amp; epoch==50 &amp; model=='EvolveGCNO' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='TGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)"),</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='wikimath' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='DCRNN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.8)")</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a><span class="co"># ], ignore_index=True)</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a><span class="co"># wikimath['nodes'] = 1068</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a><span class="co"># wikimath['time'] = 731</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a><span class="co"># wikimath = wikimath.query("mrate==0.8")</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a><span class="co"># windmillsmall = pd.concat([</span></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)"),</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==16 &amp; lags==8 &amp; epoch==50 &amp; model=='GConvLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)"),</span></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==16 &amp; lags==8 &amp; epoch==50 &amp; model=='GCLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)"),</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='LRGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)"),</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='DyGrEncoder' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)"),</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; lags==8 &amp; epoch==50 &amp; model=='EvolveGCNH' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)"),</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; lags==8 &amp; epoch==50 &amp; model=='EvolveGCNO' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)"),</span></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==12 &amp; lags==8 &amp; epoch==50 &amp; model=='TGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)"),</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='windmillsmall' &amp; mtype=='rand' &amp; inter_method == 'linear' &amp; nof_filters==4 &amp; lags==8 &amp; epoch==50 &amp; model=='DCRNN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.6 | mrate == 0.7)")</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a><span class="co"># ], ignore_index=True)</span></span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a><span class="co"># windmillsmall['nodes'] = 11</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a><span class="co"># windmillsmall['time'] = 17472</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a><span class="co"># windmillsmall = windmillsmall.query("mrate==0.7")</span></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a><span class="co"># monte = pd.concat([</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvGRU' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)"),</span></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='GConvLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)"),</span></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='GCLSTM' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)"),</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==2 &amp; lags==4 &amp; epoch==50 &amp; model=='LRGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)"),</span></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='DyGrEncoder' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)"),</span></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; lags==4 &amp; epoch==50 &amp; model=='EvolveGCNH' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)"),</span></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; lags==4 &amp; epoch==50 &amp; model=='EvolveGCNO' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)"),</span></span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==8 &amp; lags==4 &amp; epoch==50 &amp; model=='TGCN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)"),</span></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a><span class="co">#     df.query("dataset=='monte' &amp; mtype=='rand' &amp; inter_method == 'nearest' &amp; nof_filters==12 &amp; lags==4 &amp; epoch==50 &amp; model=='DCRNN' &amp; (mrate == 0.3 | mrate == 0.5 | mrate == 0.7 | mrate == 0.8)")</span></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a><span class="co"># ], ignore_index=True)</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a><span class="co"># monte['nodes'] = 675</span></span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a><span class="co"># monte['time'] = 744</span></span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a><span class="co"># monte = monte.query("mrate==0.8")</span></span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = pd.concat([fivenodes, chickenpox, pedalme, wikimath,windmillsmall, monte])</span></span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata = tidydata.sort_values(by=['time'])</span></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['model'] = pd.Categorical(tidydata['model'], categories=["GConvGRU", "GConvLSTM", "GCLSTM", "LRGCN", "DyGrEncoder", "EvolveGCNH", "EvolveGCNO", "TGCN", "DCRNN"])</span></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['method'] = pd.Categorical(tidydata['method'], categories=['STGCN', 'IT-STGCN'])</span></span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a><span class="co"># tidydata['time'] = tidydata['time'].astype(str)</span></span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a><span class="co"># fig = px.strip(tidydata,x='time',y='mse',log_y=True,color='model',facet_col='method')</span></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.annotations[0].text = 'Classic'</span></span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.annotations[1].text = 'Proposed'</span></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.xaxis.title.text = ''</span></span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.xaxis2.title.text = ''</span></span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.layout.yaxis2.showticklabels = True</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(template="seaborn")</span></span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(title_text="")</span></span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(height=1000, width=1800)</span></span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.update_layout(legend=dict(</span></span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a><span class="co">#     yanchor="top",</span></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a><span class="co">#     y=0.99,</span></span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a><span class="co">#     xanchor="left",</span></span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a><span class="co">#     x=0.01</span></span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a><span class="co">#  ))</span></span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a><span class="co"># fig</span></span></code></pre></div>
</div>
</section>
</section>
<section id="interpolation" class="level1">
<h1>3 Interpolation</h1>
<section id="linear-vs-nearest" class="level2">
<h2 class="anchored" data-anchor-id="linear-vs-nearest">3.1 Linear vs Nearest</h2>
<p><strong>Interpolation 에 따라, block은 시각적으로 보이기 좋지 않은 예시</strong></p>
<div id="4adf370b-dac9-4af0-b992-56c44393d896" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tt <span class="op">=</span> nearest_fivenodes.query(<span class="st">"dataset=='fivenodes'  and method!='GNAR' and mtype=='rand'  and nof_filters==12 and lags==2 and epoch==50 and model=='GConvGRU' and mrate in [0.3  , 0.5  , 0.6 ,0.7  , 0.8]"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>tt[<span class="st">'mrate'</span>] <span class="op">=</span> tt[<span class="st">'mrate'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>tt <span class="op">=</span> tt.sort_values(by<span class="op">=</span>[<span class="st">'model'</span>,<span class="st">'mrate'</span>])</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>tt[<span class="st">'method'</span>] <span class="op">=</span> pd.Categorical(tt[<span class="st">'method'</span>], categories<span class="op">=</span>[<span class="st">'STGCN'</span>, <span class="st">'IT-STGCN'</span>])</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.box(tt,x<span class="op">=</span><span class="st">'mrate'</span>,y<span class="op">=</span><span class="st">'mse'</span>,color<span class="op">=</span><span class="st">'method'</span>,facet_col<span class="op">=</span><span class="st">'inter_method'</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'xaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'Missing Rate'</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'yaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'MSE(log scale)'</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'blue'</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Classic'</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'blue'</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Classic'</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">2</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">2</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Proposed'</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">3</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">3</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Proposed'</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'legend'</span>][<span class="st">'title'</span>]<span class="op">=</span><span class="st">''</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>fig.update_layout(template<span class="op">=</span><span class="st">"seaborn"</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title_text<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">800</span>, width<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">0.99</span>,</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.01</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a> ))</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'nearest_fivenodes' is not defined</code></pre>
</div>
</div>
<div id="4a790af3-a0c5-4b9d-9705-90141184c59c" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nearest_fivenodes.model.unique()</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'nearest_fivenodes' is not defined</code></pre>
</div>
</div>
<div id="65d21c7b-626c-4060-adfc-121c0a6a4f38" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tt <span class="op">=</span> nearest_pedalme.query(<span class="st">"dataset=='pedalme' and method!='GNAR' and mtype=='rand' and nof_filters==12 and lags==4 and epoch==50 and model=='GConvGRU' and mrate in [0.3,0.5,0.6,0.8]"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>tt[<span class="st">'mrate'</span>] <span class="op">=</span> tt[<span class="st">'mrate'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>tt <span class="op">=</span> tt.sort_values(by<span class="op">=</span>[<span class="st">'model'</span>,<span class="st">'mrate'</span>])</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.box(tt,x<span class="op">=</span><span class="st">'mrate'</span>,y<span class="op">=</span><span class="st">'mse'</span>,color<span class="op">=</span><span class="st">'method'</span>,facet_col<span class="op">=</span><span class="st">'inter_method'</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'xaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'Missing Rate'</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'yaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'MSE(log scale)'</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'blue'</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Classic'</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'blue'</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Classic'</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">2</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">2</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Proposed'</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">3</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">3</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Proposed'</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'legend'</span>][<span class="st">'title'</span>]<span class="op">=</span><span class="st">''</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>fig.update_layout(template<span class="op">=</span><span class="st">"seaborn"</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title_text<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">800</span>, width<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">0.99</span>,</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.01</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a> ))</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'nearest_pedalme' is not defined</code></pre>
</div>
</div>
</section>
</section>
<section id="missing-type" class="level1">
<h1>4 Missing Type</h1>
<section id="block-vs-random" class="level2">
<h2 class="anchored" data-anchor-id="block-vs-random">4.1 Block vs random</h2>
<div id="dbd61f41-0d4a-4c39-8cc8-c1afc5bf8c20" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tt<span class="op">=</span>df.query(<span class="st">"mtype in ['rand','block'] and mrate in [0.2877697841726618, 0.3] and dataset=='chickenpox'"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tt[<span class="st">'mrate'</span>] <span class="op">=</span> tt[<span class="st">'mrate'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>tt <span class="op">=</span> tt.sort_values(by<span class="op">=</span>[<span class="st">'model'</span>,<span class="st">'mrate'</span>])</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.box(tt,x<span class="op">=</span><span class="st">'mrate'</span>,y<span class="op">=</span><span class="st">'mse'</span>,color<span class="op">=</span><span class="st">'method'</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'xaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'Missing Rate'</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'yaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'MSE'</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'blue'</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Classic'</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Proposed'</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'legend'</span>][<span class="st">'title'</span>]<span class="op">=</span><span class="st">''</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>fig.update_layout(template<span class="op">=</span><span class="st">"seaborn"</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title_text<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">800</span>, width<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">0.99</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.01</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a> ))</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'df' is not defined</code></pre>
</div>
</div>
<div id="78daa2ea-89a3-43c9-a7b3-3cd12a5c02e5" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tt<span class="op">=</span>df.query(<span class="st">"mtype in ['rand','block'] and mrate in [0.2857142857142857, 0.3] and model=='LRGCN' and dataset=='pedalme'"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>tt[<span class="st">'mrate'</span>] <span class="op">=</span> tt[<span class="st">'mrate'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>tt <span class="op">=</span> tt.sort_values(by<span class="op">=</span>[<span class="st">'model'</span>,<span class="st">'mrate'</span>])</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.box(tt,x<span class="op">=</span><span class="st">'mrate'</span>,y<span class="op">=</span><span class="st">'mse'</span>,color<span class="op">=</span><span class="st">'method'</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'xaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'Missing Rate'</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'yaxis'</span>][<span class="st">'title'</span>][<span class="st">'text'</span>]<span class="op">=</span><span class="st">'MSE'</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'blue'</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Classic'</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'marker'</span>][<span class="st">'color'</span>] <span class="op">=</span> <span class="st">'red'</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">1</span>][<span class="st">'name'</span>] <span class="op">=</span> <span class="st">'Proposed'</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>fig.layout[<span class="st">'legend'</span>][<span class="st">'title'</span>]<span class="op">=</span><span class="st">''</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>fig.update_layout(template<span class="op">=</span><span class="st">"seaborn"</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title_text<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">800</span>, width<span class="op">=</span><span class="dv">1800</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">0.99</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.01</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a> ))</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'df' is not defined</code></pre>
</div>
</div>
<div id="d7b94be4-c6a6-403c-9610-f494d1eb1624" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>